<UserControl x:Class="Memora.View.QuizModeView"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
      xmlns:iconPacks="http://metro.mahapps.com/winfx/xaml/iconpacks"
      xmlns:local="clr-namespace:Memora.View"
      mc:Ignorable="d">

    <UserControl.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="/Themes/StudyModeButton.xaml"/>
                <ResourceDictionary Source="/Themes/QuizQuestionButton.xaml"/>
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </UserControl.Resources>

    <Grid Background="Transparent">

        <ScrollViewer Width="auto">
            <StackPanel Orientation="Vertical">
                <ItemsControl x:Name="FlashcardList" 
                              ItemsSource="{Binding QuizAnswers}"
                                Background="Transparent"
                                BorderThickness="0"
                                Height="auto"
                                Width="auto"
                                Margin="15,15,15,15"
                                HorizontalAlignment="Center"
                                HorizontalContentAlignment="Center"
                                ScrollViewer.CanContentScroll="True"
                                ScrollViewer.VerticalScrollBarVisibility="Visible"
                                ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <Border BorderThickness="2"
                                    CornerRadius="10"
                                    Margin="5"
                                    Padding="10"
                                    BorderBrush="#DEE2E6"
                                    Background="#6366F1"
                                    Width="450"
                                    Height="auto">

                                <StackPanel Orientation="Vertical">
                                    <TextBlock Margin="2"
                                               Foreground="#FFFFFF"
                                               FontWeight="SemiBold"
                                               HorizontalAlignment="Right">
                                        <Run Text="{Binding Index}"/>
                                        <Run Text="/"/>
                                        <!-- going up the visual tree, grabbing the QuizModeViewModel and OneWay binding, which is for display only.-->
                                        <Run Text="{Binding DataContext.TotalFlashcards, RelativeSource={RelativeSource AncestorType=UserControl}, Mode=OneWay}"/>

                                    </TextBlock>
                                    <TextBlock Text="This is a template question to see how the control behaves if the text is way too long."
                                               HorizontalAlignment="Center"
                                               VerticalAlignment="Center"
                                               FontSize="20"
                                               FontWeight="Regular"
                                               Margin="10,2,10,10"
                                               TextWrapping="Wrap"
                                               TextAlignment="Justify"
                                               Foreground="#FFFFFF">

                                    </TextBlock>
                                    <StackPanel Orientation="Vertical" HorizontalAlignment="Center" VerticalAlignment="Center">
                                        <!-- logic explained here: https://stackoverflow.com/questions/58214948/on-button-click-i-want-to-send-the-button-text-to-viewmodel-mvvm -->
                                        <!-- Items control for quiz questions and answers -->
                                        <!-- Content just returns one of the list elements as a string-->
                                        <!-- Tag binds to the DataContext of the ItemsControl (so it is one object of QuizAnswer)-->
                                        <!-- Command refers to the QuizModeViewModel and grab its command "SelectAnswerCommand"-->
                                        <!-- Group name binds to the current index of the question, so each question has a unique set of radio buttons (one clickable at a time)-->
                                        <ItemsControl ItemsSource="{Binding IncorrectAnswers}">
                                            <ItemsControl.ItemTemplate>
                                                <DataTemplate>
                                                    <RadioButton Style="{StaticResource QuizAnswer}"
                                                                 Content="{Binding}"
                                                                 Tag="{Binding DataContext, RelativeSource={RelativeSource AncestorType=ItemsControl}}"
                                                                 Command="{Binding DataContext.SelectAnswerCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                                                 CommandParameter="{Binding RelativeSource={RelativeSource Mode=Self}}"
                                                                 GroupName="{Binding DataContext.Index, RelativeSource={RelativeSource AncestorType=ItemsControl}}"/>
                                                </DataTemplate>
                                            </ItemsControl.ItemTemplate>
                                        </ItemsControl>
                                            
                                        

                                    </StackPanel>
                                </StackPanel>

                            </Border>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>

                </ItemsControl>
                <!-- submit button appearing AFTER the last answer -->
                <Button Content="Check answers"
                        Style="{StaticResource StudyModeButton}"
                        Tag="{x:Static iconPacks:PackIconBootstrapIconsKind.Check2Square}"
                        Command="{Binding CheckAnswersCommand}"
                        FontWeight="SemiBold"
                        Width="155"
                        Height="55"
                        Margin="10,10,10,20"/>
            </StackPanel>
            
        </ScrollViewer>
    </Grid>
</UserControl>
